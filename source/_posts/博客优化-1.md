---
title: 搭建博客-3
date: 2023-10-28 18:30:36
tags: blog
excerpt: 博客备份
---

优化方向

1. 博客备份
2. 博客图床
3. 个性化设置，如SEO、评论系统、个人头像、博客分享、订阅功能、High功能、404网页设置等



## 博客备份

### 备份原因

上传到仓库只有生成的静态网页文件，本地的源文件删除了就不能通过git恢复了.

### 参考资料

1. [Hexo搭建个人博客（备份和迁移）-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1743949)
2. [【精选】Hexo博客的备份与恢复_hexo 博客 源丢失_木子欢儿的博客-CSDN博客](https://blog.csdn.net/muzihuaner/article/details/113880440)
3. [添加远程库 - 廖雪峰的官方网站 (liaoxuefeng.com)](https://www.liaoxuefeng.com/wiki/896043488029600/898732864121440)
4. [git remote命令查看远程仓库信息时，出现new ( next fetch will store in remotes/origin)提示-CSDN博客](https://blog.csdn.net/whu_zhangmin/article/details/12944999)
5. [Error：pathspec 'master' did not match any files known to git_master did not match-CSDN博客](https://blog.csdn.net/benben_2015/article/details/82867345)  切换分支的报错参考
6. [Hexo博客源文件备份 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/553144729)
7. [Git命令手动备份Hexo博客源文件-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/1964358)

### 备用

1. [上传本地文件（夹）到GitHub和更新仓库文件 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/136355306)
2. [Git 分支管理 | 菜鸟教程 (runoob.com)](https://www.runoob.com/git/git-branch.html)
10. [使用hexo-git-backup插件备份博客源文件-CSDN博客](https://blog.csdn.net/qq_41793001/article/details/103151182)





## 预先处理

### 删除 .git

将hexo的主题下的`.git`删除，比如删除themes/next/目录下的.git否则无法将主题文件夹push。（不能重复包含.git）



### 创建.gitignore

在本地blog文件夹下创建文件`.gitignore`（格式：所有文件），正常情况这个文件是自动生成的，打开后写入：

```
.DS_Store
Thumbs.db
db.json
*.log
node_modules/
public/
.deploy*/
```

这个文件的存在是指在push的时候忽略文件中的文件格式。



## 分支操作

```
#git初始化，好像会创建一个默认仓库，如果有仓库就没有影响。
git init

#创建hexo分支，用来存放源码
git checkout -b hexo

#git 文件添加
git add .

#git 提交
git commit -m "backup"

#添加远程仓库，github上的博客仓库 
git remote add origin git@gitHub.com:用户名/仓库名.git

#push到hexo分支
git push origin hexo
```

### 注意

1. 在git中，可利用checkout命令转换分支，该命令的作用就是切换分支或恢复工作树文件，语法为“git checkout 分支名”；当参数设置为“-b”时，可以在新分支创建的同时切换分支，语法为“git checkout -b 分支名”。
2. origin是远程仓库的命名，你的仓库的小名。**关联到远程库是git操作(远程库的分支等操作），部署是hexo操作（部署到仓库)。**



## 分支的问题

1. `ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)`命令后缀是hexo，说明源文件提交到的分支是它？但是config里部署的分支是master
2. 网页访问的仓库地址时是访问有生成文件的master分支，但是master分支为什么更新了？表明部署成功了
3. 我的GitHub仓库只有master和hexo两个分支，我使用hexo分支备份源文件，master分支存储生成文件，是部署同时把源文件也上传了吗？
4. 虽然本地命令行说明是hexo分支，也能达成备份和更新的目的，但我在考虑是否需要更换到master



## 注意是手动备份

也就是说需要重复备份才会更新GitHub上hexo分支上储存的源文件（查看GitHub备份的源文件后发现还是初始上传的样子），分支的问题1-3是因为没有搞清楚是手动备份，还是部署到master分支

问题4有点错误，现在只是手动备份了一次。

备份路径的后缀是hexo，不用修改了，以后也要手动备份到这。



## 切换分支记录

```
ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git checkout master
error: pathspec 'master' did not match any file(s) known to git

ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git branch -a
* hexo
  remotes/origin/hexo

ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git remote show origin
* remote origin
  Fetch URL: git@github.com:narrciss/narrciss.github.io.git
  Push  URL: git@github.com:narrciss/narrciss.github.io.git
  HEAD branch: master
  Remote branches:
    hexo   tracked
    master new (next fetch will store in remotes/origin)
  Local ref configured for 'git push':
    hexo pushes to hexo (up to date)

ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git checkout /remotes/origin/master
fatal: Invalid path 'D:/Git/remotes': No such file or directory

ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git remote -v
origin  git@github.com:narrciss/narrciss.github.io.git (fetch)
origin  git@github.com:narrciss/narrciss.github.io.git (push)

```



### 部署时，master分支设置为追踪

不知道作用

```
To https://github.com/narrciss/narrciss.github.io.git
 + f107820...b31a274 HEAD -> master (forced update)
branch 'master' set up to track 'https://github.com/narrciss/narrciss.github.io.git/master'.
INFO  Deploy done: git

```





## 同步分支信息

使用 git fetch origin 命令同步分支信息（参考资料6）

原来，git branch -a 输出的是本地仓库的远程分支信息，

而git remote show origin需要联网输出实时的远程仓库的分支信息。

出现new ( next fetch will store in remotes/origin)，由于远程新增了分支，而本地并没有同步信息导致的。

```
ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git fetch origin
remote: Enumerating objects: 364, done.
remote: Counting objects: 100% (364/364), done.
remote: Compressing objects: 100% (234/234), done.
remote: Total 364 (delta 65), reused 364 (delta 65), pack-reused 0
Receiving objects: 100% (364/364), 7.39 MiB | 1.68 MiB/s, done.
Resolving deltas: 100% (65/65), done.
From github.com:narrciss/narrciss.github.io
 * [new branch]      master     -> origin/master

ASUS@LAPTOP-GEMI5NEH MINGW64 /d/Blog/blog2 (hexo)
$ git branch -a
* hexo
  remotes/origin/hexo
  remotes/origin/master
  
```



## 以后手动备份的操作

以后更新备份使用：

```text
git add .
git commit  -m  "backup"
git push origin 分支名 
```





## 总结命令

```
git init
git checkout -b hexo
git add .
git commit -m "backup"
git remote add origin git@gitHub.com:用户名/仓库名.git
git push origin hexo

git checkout origin/master
git checkout master

git branch -a
git remote show origin
git remote -v

git fetch origin
```

